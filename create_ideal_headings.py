# -*- coding: utf-8 -*-
# create_ideal_headings.py

import os
from src.gemini_generator import GeminiGenerator
from dotenv import load_dotenv

def main():
    """
    与えられた高品質なデータセットから、理想的な12個の見出し構成案を生成するための
    一度きりの分析用スクリプト。
    """
    load_dotenv()
    
    # ユーザーから提供された高品質なデータ
    main_keyword = "ワークマン　空調服"
    
    related_suggests = """
    ワークマンで一番涼しいパンツは？
    ワークマンの冷感機能の効果は何ですか？
    ワークマンで首に巻く冷たいやつは何ですか？
    ワークマンのリカバリーウェアとは何ですか？
    冷感敷きパッドはなぜ冷たいのでしょうか？
    冷感インナーの効果は何ですか？
    持続冷感とは何ですか？
    ワークマンの電熱ベストはどのくらい使えますか？
    ワークマンのヒートアシストとは何ですか？
    氷撃インナーの効果とは？
    Q-maxの最高値はいくつですか？
    フリーズテックの効果とは？
    冷感タオルにはどんな効果があるのですか？
    冷感素材はなぜ冷たいのでしょうか？
    接触温冷感とは何ですか？
    空調服 涼しい ランキング
    ワークマン 空調服 バッテリーセット24v
    空調服 最強 24v
    ワークマン 空調服 バッテリーセット 値段
    空調服 コスパ最強
    空調服 おすすめ
    ワークマン 空調服 バッテリーセット24v 口コミ
    ワークマン 空調服 バートル
    空調服はベストと半袖のどちらがいいですか？
    空調服はなぜ禁止されているのですか？
    空調服より涼しい服は？
    空調服の下には何を着ればよいですか？
    空調服は熱中症対策になりますか？
    ワークマンで首に巻く冷たいやつは何ですか？
    空調服 何が1番涼しい？
    空調服は毎日洗うべきですか？
    ワークマンの空調服のブランドは？
    ワークマン 着るエアコン いくら？
    バートル19Vは何時間持つ？
    空調服の12Vと24Vの違いは何ですか？
    空調服がダメな理由は何ですか？
    空調服のバッテリーは何年くらい持ちますか？
    ベルトファンと空調服、どちらが涼しいですか？
    空調服は雨の日でも大丈夫ですか？
    ワークマンの防寒着は何度まで着られますか？
    空調服ってどうなの？
    ワークマンの製品が安い理由は何ですか？
    ワークマンでおすすめの防寒着は？
    空調服は何時間持つ？
    空調服の電気代はいくらですか？
    ワークマンが冷暖房を兼ね備えた「着るエアコン」とは？
    バートルはなぜ人気があるのですか？
    空調服にフードが付いているメリットは？
    バートルの寿命はどれくらいですか？
    ワークマンでバートルは売ってますか？
    ワークマンの空調服はどのくらい使えますか？
    バートル空調服2025は互換性がありますか？
    ワークマンは値引き販売をしないのはなぜですか？
    WORKMANとWORKMANプラスの違いは何ですか？
    ワークマンはどこの傘下ですか？
    水冷服と空調服のどちらがよいですか？
    空調服は体温を下げますか？
    ワークマン 着るエアコン いくら？
    ワークマンの会員になるとどんなメリットがありますか？
    ワークマンでサイズが合わなかった商品の返品はできますか？
    ワークマンの初期費用はいくらですか？
    ワークマンのライバル店は？
    カインズはどこの国に本社がありますか？
    ワークマンの昔の名前は？
    一度着用した服は返品できますか？
    ワークマンでレシートをなくしたら交換してもらえますか？
    ワークマンでクレジットカードは使えますか？
    """

    # この分析のためだけの、特別なプロンプト
    analysis_prompt = f"""
あなたは、ユーザーの検索意図を完璧に読み解き、最高の記事構成を作り上げるプロのSEO編集長です。

# あなたのタスク
以下の「メインキーワード」と、それに関連する膨大な「関連サジェスト一覧」を深く分析し、アフィリエイト収益を最大化するための、**完璧な12個の記事見出し**を作成してください。
これは、今後のAIのモデルとなる「理想のお手本」を作成するための、非常に重要なタスクです。

# 作成の絶対原則
1.  **検索意図の網羅**: 「関連サジェスト一覧」に含まれるユーザーの疑問や興味（価格、比較、使い方、口コミ、問題点など）を、12の見出しで可能な限り網羅してください。
2.  **論理的な構成**: 読者が自然に読み進められるよう、「導入」→「比較・検討」→「活用・応用」というストーリーを意識して見出しを並べてください。
3.  **キーワードの自然な分散（最重要）**:
    - メインキーワードの構成語（「ワークマン」「空調服」）が、特定の見出しに集中したり、不必要に繰り返されたりしないよう、細心の注意を払ってください。
    - ブランド名（ワークマン、バートルなど）は、比較や特定の製品を指す場合にのみ使用してください。
    - 一般的なトピック（洗濯方法、バッテリー寿命など）では、主語を省略するか、一般的な言葉を使ってください。
    - 全ての見出しが同じ単語で始まらないように、表現の多様性を追求してください。

# 入力データ
## メインキーワード:
{main_keyword}

## 関連サジェスト一覧:
{related_suggests}

# 出力形式
- 完成した12個の見出しのみを、1行ずつ改行して出力してください。
- 説明、パート名、番号、その他の装飾は一切不要です。
"""

    try:
        print("[分析開始] 理想的な見出し構成案を生成します...")
        gemini = GeminiGenerator()
        ideal_headings = gemini.generate(analysis_prompt)
        
        print("\n--- 生成された「理想の見出し構成案」 ---")
        print(ideal_headings)
        
        # 結果をファイルに保存
        with open("ideal_headings_output.txt", "w", encoding="utf-8") as f:
            f.write(ideal_headings)
        print("\n[成功] 結果を 'ideal_headings_output.txt' に保存しました。")
        print("この結果を基に、メインプログラムのプロンプトを改善します。")

    except Exception as e:
        print(f"\n[エラー] 分析中にエラーが発生しました: {e}")

if __name__ == "__main__":
    main()
