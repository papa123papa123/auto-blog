# -*- coding: utf-8 -*-
# create_ideal_headings.py

import os
from src.gemini_generator import GeminiGenerator
from dotenv import load_dotenv

def main():
    """
    与えられた高品質なデータセットから、理想的な12個の見出し構成案を生成するための
    一度きりの分析用スクリプト。
    """
    load_dotenv()
    
    # ユーザーから提供された高品質なデータ
    main_keyword = "ワークマン　空調服"
    
    related_suggests = """
    ワークマンで一番涼しいパンツは？
    ワークマンの冷感機能の効果は何ですか？
    ワークマンで首に巻く冷たいやつは何ですか？
    ワークマンのリカバリーウェアとは何ですか？
    冷感敷きパッドはなぜ冷たいのでしょうか？
    冷感インナーの効果は何ですか？
    持続冷感とは何ですか？
    ワークマンの電熱ベストはどのくらい使えますか？
    ワークマンのヒートアシストとは何ですか？
    氷撃インナーの効果とは？
    Q-maxの最高値はいくつですか？
    フリーズテックの効果とは？
    冷感タオルにはどんな効果があるのですか？
    冷感素材はなぜ冷たいのでしょうか？
    接触温冷感とは何ですか？
    空調服 涼しい ランキング
    ワークマン 空調服 バッテリーセット24v
    空調服 最強 24v
    ワークマン 空調服 バッテリーセット 値段
    空調服 コスパ最強
    空調服 おすすめ
    ワークマン 空調服 バッテリーセット24v 口コミ
    ワークマン 空調服 バートル
    空調服はベストと半袖のどちらがいいですか？
    空調服はなぜ禁止されているのですか？
    空調服より涼しい服は？
    空調服の下には何を着ればよいですか？
    空調服は熱中症対策になりますか？
    ワークマンで首に巻く冷たいやつは何ですか？
    空調服 何が1番涼しい？
    空調服は毎日洗うべきですか？
    ワークマンの空調服のブランドは？
    ワークマン 着るエアコン いくら？
    バートル19Vは何時間持つ？
    空調服の12Vと24Vの違いは何ですか？
    空調服がダメな理由は何ですか？
    空調服のバッテリーは何年くらい持ちますか？
    ベルトファンと空調服、どちらが涼しいですか？
    空調服は雨の日でも大丈夫ですか？
    ワークマンの防寒着は何度まで着られますか？
    空調服ってどうなの？
    ワークマンの製品が安い理由は何ですか？
    ワークマンでおすすめの防寒着は？
    空調服は何時間持つ？
    空調服の電気代はいくらですか？
    ワークマンが冷暖房を兼ね備えた「着るエアコン」とは？
    バートルはなぜ人気があるのですか？
    空調服にフードが付いているメリットは？
    バートルの寿命はどれくらいですか？
    ワークマンでバートルは売ってますか？
    ワークマンの空調服はどのくらい使えますか？
    バートル空調服2025は互換性がありますか？
    ワークマンは値引き販売をしないのはなぜですか？
    WORKMANとWORKMANプラスの違いは何ですか？
    ワークマンはどこの傘下ですか？
    水冷服と空調服のどちらがよいですか？
    空調服は体温を下げますか？
    ワークマン 着るエアコン いくら？
    ワークマンの会員になるとどんなメリットがありますか？
    ワークマンでサイズが合わなかった商品の返品はできますか？
    ワークマンの初期費用はいくらですか？
    ワークマンのライバル店は？
    カインズはどこの国に本社がありますか？
    ワークマンの昔の名前は？
    一度着用した服は返品できますか？
    ワークマンでレシートをなくしたら交換してもらえますか？
    ワークマンでクレジットカードは使えますか？
    """

    # この分析のためだけの、特別なプロンプト
    analysis_prompt = f"""
あなたは、ユーザーの検索意図を完璧に読み解き、最高の記事構成を作り上げるプロのSEO編集長です。

# 絶対遵守の構造ルール
- **H2見出し**: 2個（各H2にメインキーワードの全単語を含める）
- **H3見出し**: 各H2の下に6個ずつ（合計12個）
- **見出しの文字数**: 各見出しは25文字以内（記号含まず）

# 最重要ルール（優先順位順）

## 【ルール1: キーワード制御】
- **H2見出し**: メインキーワードの全単語を必ず含める
- **H3見出し**: メインキーワードの単語は絶対使用禁止
- **例**: 「夏 お酒 ピッタリ」の場合：
  - H2-1: 「夏のお酒選びとピッタリなおつまみの基本」
  - H2-2: 「夏のお酒とピッタリなおつまみの活用」
  - H3-1: 「そもそもどんなもの？」（「夏」「お酒」「ピッタリ」は使用禁止）

## 【ルール2: YMYL領域回避】
- **避ける表現**: 「治療」「儲かる」「法的保証」「必ず購入」
- **使用する表現**: 「快適性」「体験談」「比較検討」「参考情報」

## 【ルール3: ブランド名重複回避】
- 同じブランド名がしつこく重複しないよう配慮
- 比較・特定の製品を指す場合のみ使用

# H2×H3の役割と配置（絶対遵守）

## 【H2第1章：基本理解と選び方】
### H3-1: 「そもそも何？」役割
- 基本概念・定義（メインKWの単語は使用禁止）
- 初心者でも分かる簡単な説明

### H3-2: 「どんな種類がある？」役割  
- 分類・カテゴリーの整理
- それぞれの特徴・違い

### H3-3: 「どうやって選ぶ？」役割
- 選び方の基本原則・チェックポイント
- 初心者向けの選び方ガイド

### H3-4: 「どれがいい？」役割
- 具体的な比較・ランキング
- おすすめ商品・サービスの紹介

### H3-5: 「実際どう？」役割
- 口コミ・体験談・評判
- 実際の使用感・効果

### H3-6: 「注意点は？」役割
- デメリット・問題点・リスク
- 購入前に知っておくべきこと

## 【H2第2章：活用と購入】
### H3-7: 「どう使う？」役割
- 使用方法・コツ・テクニック
- 効果を最大化する使い方

### H3-8: 「どう手入れ？」役割
- メンテナンス・お手入れ方法
- 長持ちさせるコツ

### H3-9: 「どんな場面で？」役割
- 活用シーン・応用方法
- 季節・状況別の使い分け

### H3-10: 「どこで買う？」役割
- 購入場所・価格・お得情報
- 通販・店舗の比較

### H3-11: 「買った後は？」役割
- アフターサービス・サポート
- 保証・返品・交換

### H3-12: 「まとめ」役割（最重要）
- **メインキーワードの単語は絶対使用禁止**
- **YMYL領域の表現は絶対使用禁止**
- 記事全体の要点を簡潔に整理
- 読者の次の行動（比較・検討など）を安全に促す

# 出力形式
- JSON形式で出力してください
- H2見出し2個、H3見出し12個を含めてください

# 入力データ
## メインキーワード: {main_keyword}
## 関連サジェスト一覧: {related_suggests}
"""

    try:
        print("[分析開始] 理想的な見出し構成案を生成します...")
        gemini = GeminiGenerator()
        ideal_headings = gemini.generate(analysis_prompt)
        
        print("\n--- 生成された「理想の見出し構成案」 ---")
        print(ideal_headings)
        
        # 結果をファイルに保存
        with open("ideal_headings_output.txt", "w", encoding="utf-8") as f:
            f.write(ideal_headings)
        print("\n[成功] 結果を 'ideal_headings_output.txt' に保存しました。")
        print("この結果を基に、メインプログラムのプロンプトを改善します。")

    except Exception as e:
        print(f"\n[エラー] 分析中にエラーが発生しました: {e}")

if __name__ == "__main__":
    main()
